<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>request matching • vcr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="request matching">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vcr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/vcr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/configuration.html">vcr configuration</a>
    </li>
    <li>
      <a href="../articles/request_matching.html">request matching</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ropensci/vcr">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>request matching</h1>
                        <h4 class="author">Scott Chamberlain</h4>
            
            <h4 class="date">2019-08-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/vcr/blob/master/vignettes/request_matching.Rmd"><code>vignettes/request_matching.Rmd</code></a></small>
      <div class="hidden name"><code>request_matching.Rmd</code></div>

    </div>

    
    
<div id="request-matching" class="section level1">
<h1 class="hasAnchor">
<a href="#request-matching" class="anchor"></a>Request matching</h1>
<p>To match previously recorded requests, <code>vcr</code> has to try to match new HTTP requests to a previously recorded one. By default, we match on HTTP method (e.g., <code>GET</code>) and URI (e.g., <code>http://foo.com</code>), following Ruby’s VCR gem.</p>
<p>You can customize how we match requests with one or more of the following options, some of which are on by default, some of which can be used together, and some alone.</p>
<ul>
<li>
<code>method</code>: Use the <strong>method</strong> request matcher to match requests on the HTTP method (i.e. GET, POST, PUT, DELETE, etc). You will generally want to use this matcher. The <strong>method</strong> matcher is used (along with the <strong>uri</strong> matcher) by default if you do not specify how requests should match.</li>
<li>
<code>uri</code>: Use the <strong>uri</strong> request matcher to match requests on the request URI. The <strong>uri</strong> matcher is used (along with the <strong>method</strong> matcher) by default if you do not specify how requests should match.</li>
<li>
<code>host</code>: Use the <strong>host</strong> request matcher to match requests on the request host. You can use this (alone, or in combination with <strong>path</strong>) as an alternative to <strong>uri</strong> so that non-deterministic portions of the URI are not considered as part of the request matching.</li>
<li>
<code>path</code>: Use the <strong>path</strong> request matcher to match requests on the path portion of the request URI. You can use this (alone, or in combination with <strong>host</strong>) as an alternative to <strong>uri</strong> so that non-deterministic portions of the URI</li>
<li>
<code>query</code>: Use the <strong>query</strong> request matcher to match requests on the query string portion of the request URI. You can use this (alone, or in combination with others) as an alternative to <strong>uri</strong> so that non-deterministic portions of the URI are not considered as part of the request matching.</li>
<li>
<code>body</code>: Use the <strong>body</strong> request matcher to match requests on the request body.</li>
<li>
<code>headers</code>: Use the <strong>headers</strong> request matcher to match requests on the request headers.</li>
</ul>
<p>You can set your own options by tweaking the <code>match_requests_on</code> parameter in <code><a href="../reference/use_cassette.html">use_cassette()</a></code>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(vcr)</a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="../reference/use_cassette.html">use_cassette</a></span>(<span class="dt">name =</span> <span class="st">"foo_bar"</span>, {</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">    cli<span class="op">$</span><span class="kw">post</span>(<span class="st">"post"</span>, <span class="dt">body =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">a =</span> <span class="dv">5</span>))</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">  }, </a>
<a class="sourceLine" id="cb2-4" data-line-number="4">  <span class="dt">match_requests_on =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'method'</span>, <span class="st">'headers'</span>, <span class="st">'body'</span>)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">)</a></code></pre></div>
<div id="matching" class="section level2">
<h2 class="hasAnchor">
<a href="#matching" class="anchor"></a>Matching</h2>
<div id="headers" class="section level3">
<h3 class="hasAnchor">
<a href="#headers" class="anchor"></a>headers</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(crul)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(vcr)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">cli &lt;-<span class="st"> </span>crul<span class="op">::</span>HttpClient<span class="op">$</span><span class="kw">new</span>(<span class="st">"https://httpbin.org/get"</span>, </a>
<a class="sourceLine" id="cb3-4" data-line-number="4">  <span class="dt">headers =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">foo =</span> <span class="st">"bar"</span>))</a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="kw"><a href="../reference/use_cassette.html">use_cassette</a></span>(<span class="dt">name =</span> <span class="st">"nothing_new"</span>, {</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">    one &lt;-<span class="st"> </span>cli<span class="op">$</span><span class="kw"><a href="https://rdrr.io/r/base/get.html">get</a></span>()</a>
<a class="sourceLine" id="cb3-7" data-line-number="7">  }, </a>
<a class="sourceLine" id="cb3-8" data-line-number="8">  <span class="dt">match_requests_on =</span> <span class="st">'headers'</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9">)</a>
<a class="sourceLine" id="cb3-10" data-line-number="10">cli<span class="op">$</span>headers<span class="op">$</span>foo &lt;-<span class="st"> "stuff"</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="kw"><a href="../reference/use_cassette.html">use_cassette</a></span>(<span class="dt">name =</span> <span class="st">"nothing_new"</span>, {</a>
<a class="sourceLine" id="cb3-12" data-line-number="12">    two &lt;-<span class="st"> </span>cli<span class="op">$</span><span class="kw"><a href="https://rdrr.io/r/base/get.html">get</a></span>()</a>
<a class="sourceLine" id="cb3-13" data-line-number="13">  }, </a>
<a class="sourceLine" id="cb3-14" data-line-number="14">  <span class="dt">match_requests_on =</span> <span class="st">'headers'</span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15">)</a>
<a class="sourceLine" id="cb3-16" data-line-number="16">one<span class="op">$</span>request_headers</a>
<a class="sourceLine" id="cb3-17" data-line-number="17">two<span class="op">$</span>request_headers</a></code></pre></div>
</div>
</div>
<div id="more-documentation" class="section level2">
<h2 class="hasAnchor">
<a href="#more-documentation" class="anchor"></a>More documentation</h2>
<p>Check out the <a href="https://ropenscilabs.github.io/http-testing-book/">http testing book</a> for a lot more documentation on <code>vcr</code>, <code>webmockr</code>, and <code>crul</code></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#request-matching">Request matching</a><ul class="nav nav-pills nav-stacked">
<li><a href="#matching">Matching</a></li>
      <li><a href="#more-documentation">More documentation</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Scott Chamberlain.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.9100.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
